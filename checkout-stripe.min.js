window.StripeUtilities = {}, window.StripeUtilities.StripeCheckoutWrapper = function(e, t, o) {
    var i, n, c, a = {},
        p = (o = o || {}, "initializing");
    return "production" === t ? (n = "pk_live_M3pcr0YEp4395yqH5gHVsmhc", c = "https://www.prodigygame.com/membership-api/v1/") : "staging" === t ? (n = "pk_test_IMt6DAznCfweWxpQMYEbDRFr", c = "https://www.prodigygame.org/membership-api/v1/") : (n = "pk_test_ZYIDOnDhEw9Dia61ad2FGHmH", c = "https://danny-qa.prodigygame.org/membership-api/v1/"), i = StripeCheckout.configure({
        key: n,
        image: "https://s3.amazonaws.com/stripe-uploads/acct_1uHJuagHrUveG4F55AQkmerchant-icon-1423856248513-Prodigy-Ed-Small.jpg",
        locale: "auto",
        allowRememberMe: !1,
        token: function(t) {
            p = "token_generated", $.post(c + "users/" + e + "/purchase-item", {
                token: t,
                itemInformation: a
            }).done((function(e) {
                p = "purchase_complete", "function" == typeof o.onSuccess && o.onSuccess(e)
            })).fail((function(e) {
                console.warn("StripeCheckoutWrapper - Failed to complete Transaction"), p = "purchase_failed", "function" == typeof o.onFail && o.onFail(e)
            }))
        },
        closed: function() {
            "function" == typeof o.onClose && o.onClose(), "checkout_active" === p && o.onUserCancel()
        }
    }), window.addEventListener("popstate", (function() {
        i.close()
    })), p = "initialized", {
        purchase: function(e, t, o, n) {
            p = "checkout_active", i.open(function(e, t, o, i) {
                return a = {
                    itemId: e,
                    itemType: t,
                    itemDescription: o,
                    amount: i
                }, {
                    name: "www.prodigygame.com",
                    zipCode: !0,
                    description: o,
                    amount: i
                }
            }(e, t, o, n)), _.defer((function() {
                $(".stripe_checkout_app").css("background-color", "#000")
            }))
        }
    }
};